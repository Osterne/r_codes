#=================================================================================================#
#=================================================================================================#
#=================================================================================================#
#=================================================================================================#
#=================================================================================================#
#=================================================================================================#
#                                                                                                 #
#                                                                                                 #
#                                                                                                 #
#                         Correlation structures - By Vin√≠cius Osterne)                           #
#                                                                                                 #
#                                                                                                 #
#                                                                                                 #
#=================================================================================================#
#=================================================================================================#
#=================================================================================================#
#=================================================================================================#
#=================================================================================================#
#=================================================================================================#

#rm(list = ls())

#=================================================================================================
#Structure of correlation
#=================================================================================================


#Uniform structure ----------------------------------------------------------------------------------
#cor.uni = function(data){
#  
#  b = data
#  ncols = length(b[1,])
#  num = sum(apply(b[,-natt]*b[,-1],1,sum))
#  den = sqrt(sum(apply(b[,-natt]^2,1,sum))*sum(apply(b[,-1]^2,1,sum)))
#  rho = num/den
#  print(AR1(ncols,rho))
#  
#}








#AR-1 structure ----------------------------------------------------------------------------------
cor.ar1 = function(data){
  library("CVTuningCov") #AR matrix
  b = data
  natt = length(b[1,])
  ncols = length(b[1,])
  num = sum(apply(b[,-natt]*b[,-1],1,sum))
  den = sqrt(sum(apply(b[,-natt]^2,1,sum))*sum(apply(b[,-1]^2,1,sum)))
  rho = num/den
  return(AR1(ncols,rho))
  
}




#Unstructured structure ----------------------------------------------------------------------------------
cor.uns = function(data){
  b = data
  ncols = length(b[1,])
  rho = diag(1, ncols)
  for(i in 1:ncols){
    for (j in 1:ncols) {
      rho[i,j] = sum(b[,i]*b[,j])/(sqrt(sum(b[,i]^2))*sqrt(sum(b[,j]^2)))
    }
  }
  return(rho)
}









#=================================================================================================
# Load the command
#=================================================================================================

save("cor.ar1", file="corAR1.Rdata")
save("cor.uns", file="corUNS.Rdata")
#load("corAR1.Rdata")
#load("corUNS.Rdata")









#=================================================================================================
# Quasi-likelihood classifier function
#=================================================================================================

# Previous information for function --------------------------------------------------------------
#data = read.csv(choose.files(), header = T, sep = ";", dec = ",")
#head(data)
#y = data[,1]
##X = data[,-c(1)]
#X = matrix(cbind(as.numeric(X[,1]), as.numeric(X[,2]), as.numeric(X[,3]), as.numeric(X[,4])), nrow = length(X[,1]), ncol = length(X[1,]))


#cor.uns(X)
#cor.ar1(X)



